# Internationalization (i18n) Documentation

**Last Updated**: 2026-01-02
**Supported Languages**: English (en-US), Bahasa Indonesia (id-ID)
**Total Translation Keys**: 1,081 per language

## Overview

The Restaurant POS system supports full internationalization using [i18next](https://www.i18next.com/) and [react-i18next](https://react.i18next.com/). All user-facing text is translatable, and language preferences persist across sessions.

## Architecture

### Technology Stack

| Component | Technology | Purpose |
|-----------|------------|---------|
| Core Library | i18next v25.7.2 | Translation framework |
| React Integration | react-i18next v16.5.0 | React hooks and components |
| Storage | localStorage | Persist language preference |
| Fallback | English (en-US) | Default when translation missing |

### File Structure

```
frontend/src/
├── i18n.ts                    # i18next configuration
├── locales/
│   ├── en-US.json            # English translations (1,081 keys)
│   └── id-ID.json            # Indonesian translations (1,081 keys)
├── components/
│   ├── admin/                # 38 components with i18n
│   ├── pos/                  # 26 components with i18n
│   ├── kitchen/              # Kitchen display components
│   └── public/               # 26 public website components
└── routes/
    ├── admin/                # Admin routes with i18n
    └── site/                 # Public routes with i18n
```

## Translation Key Namespaces

Translation keys are organized by feature area using dot notation:

| Namespace | Description | Example Keys |
|-----------|-------------|--------------|
| `common.*` | Shared UI elements | `common.save`, `common.cancel`, `common.loading` |
| `auth.*` | Authentication | `auth.login`, `auth.logout`, `auth.password` |
| `admin.*` | Admin panel | `admin.dashboard`, `admin.staff`, `admin.menu` |
| `pos.*` | Point of sale | `pos.cart`, `pos.checkout`, `pos.payment` |
| `kitchen.*` | Kitchen display | `kitchen.preparing`, `kitchen.ready`, `kitchen.completed` |
| `public.*` | Public website | `public.home`, `public.menu`, `public.aboutUs` |
| `reservation.*` | Reservation system | `reservation.fullName`, `reservation.date` |
| `contact.*` | Contact forms | `contact.name`, `contact.subject`, `contact.message` |
| `orders.*` | Order management | `orders.orderNumber`, `orders.status` |
| `inventory.*` | Inventory | `inventory.currentStock`, `inventory.lowStock` |
| `navigation.*` | Navigation menus | `navigation.home`, `navigation.dashboard` |
| `settings.*` | Settings page | `settings.language`, `settings.taxRate` |
| `notifications.*` | Notifications | `notifications.newOrder`, `notifications.lowStock` |
| `validation.*` | Form validation | `validation.required`, `validation.email` |
| `errors.*` | Error messages | `errors.network`, `errors.serverError` |
| `roles.*` | User roles | `roles.admin`, `roles.server`, `roles.kitchen` |
| `reports.*` | Reports | `reports.salesReport`, `reports.totalOrders` |
| `payment.*` | Payment | `payment.cash`, `payment.card`, `payment.digitalWallet` |

## Usage Guide

### Basic Usage in Components

```tsx
import { useTranslation } from 'react-i18next';

function MyComponent() {
  const { t } = useTranslation();

  return (
    <div>
      <h1>{t('admin.dashboard')}</h1>
      <button>{t('common.save')}</button>
    </div>
  );
}
```

### Dynamic Values (Interpolation)

```tsx
// Translation key: "orders.itemsCount": "{{count}} items"
const { t } = useTranslation();
return <span>{t('orders.itemsCount', { count: 5 })}</span>;
// Output: "5 items"
```

### Pluralization

```tsx
// Translation keys:
// "kitchen.activeOrders": "{{count}} active orders"
// "kitchen.activeOrders_one": "{{count}} active order"
const { t } = useTranslation();
return <span>{t('kitchen.activeOrders', { count: 1 })}</span>;
// Output: "1 active order"
```

### Changing Language Programmatically

```tsx
import { useTranslation } from 'react-i18next';

function LanguageSwitcher() {
  const { i18n } = useTranslation();

  const changeLanguage = (langCode: string) => {
    i18n.changeLanguage(langCode);
    localStorage.setItem('i18nextLng', langCode);
  };

  return (
    <div>
      <button onClick={() => changeLanguage('en-US')}>English</button>
      <button onClick={() => changeLanguage('id-ID')}>Indonesia</button>
    </div>
  );
}
```

## Adding New Translations

### Step 1: Add to English File

Add the key to `frontend/src/locales/en-US.json`:

```json
{
  "myNamespace": {
    "myKey": "English text here"
  }
}
```

### Step 2: Add to Indonesian File

Add the same key to `frontend/src/locales/id-ID.json`:

```json
{
  "myNamespace": {
    "myKey": "Teks Indonesia di sini"
  }
}
```

### Step 3: Use in Component

```tsx
const { t } = useTranslation();
return <span>{t('myNamespace.myKey')}</span>;
```

## Language Switcher Locations

| Interface | Component | Location |
|-----------|-----------|----------|
| Admin Panel | `AdminSettings.tsx` | Settings page |
| Public Website | `Header.tsx` | Navigation header (desktop & mobile) |
| All Interfaces | `LanguageSwitcher.tsx` | Standalone component |

## Testing

### E2E Tests

```bash
cd frontend
npm run test:e2e -- --grep "indonesian|language"
```

Test files:
- `tests/e2e/language-switch.spec.ts` - Admin language switching
- `tests/e2e/pos-indonesian.spec.ts` - POS in Indonesian
- `tests/e2e/kitchen-indonesian.spec.ts` - Kitchen in Indonesian
- `tests/e2e/public-indonesian.spec.ts` - Public website in Indonesian

### Manual Testing

1. Navigate to Admin Settings (`/admin/settings`)
2. Click language button (English/Indonesia)
3. Verify all visible text changes
4. Refresh page - language should persist
5. Navigate to different sections - language should remain

## Troubleshooting

### Translation Key Shows Instead of Text

**Symptom**: Raw key like `admin.dashboard` appears instead of translated text

**Causes**:
1. Key doesn't exist in translation file
2. Typo in key name
3. Component not using `useTranslation` hook

**Solution**:
- Check both locale files for the key
- Verify spelling matches exactly
- Add `const { t } = useTranslation()` to component

### Language Doesn't Persist

**Symptom**: Language resets to English on refresh

**Causes**:
1. localStorage blocked or cleared
2. `i18nextLng` key not being saved

**Solution**:
- Check browser localStorage for `i18nextLng` key
- Verify the language change function includes `localStorage.setItem()`

### Component Doesn't Update

**Symptom**: Some text doesn't change when language is switched

**Causes**:
1. Hardcoded text not using `t()` function
2. Component not re-rendering on language change

**Solution**:
- Replace hardcoded strings with `t('key')`
- Ensure component uses `useTranslation` hook

## Configuration

### i18n.ts Settings

```typescript
i18n
  .use(LanguageDetector)
  .use(initReactI18next)
  .init({
    resources: {
      'en-US': { translation: enUS },
      'id-ID': { translation: idID },
    },
    fallbackLng: 'en-US',
    interpolation: {
      escapeValue: false,
    },
    detection: {
      order: ['localStorage', 'navigator'],
      lookupLocalStorage: 'i18nextLng',
      caches: ['localStorage'],
    },
  });
```

### Key Configuration Options

| Option | Value | Description |
|--------|-------|-------------|
| `fallbackLng` | `'en-US'` | Default language if detection fails |
| `detection.order` | `['localStorage', 'navigator']` | Priority for language detection |
| `detection.lookupLocalStorage` | `'i18nextLng'` | localStorage key name |

## Best Practices

1. **Always use namespaces**: Group related keys under meaningful namespaces
2. **Keep keys descriptive**: Use `admin.staff.addButton` not `button1`
3. **Avoid sentence fragments**: Translate complete sentences for better context
4. **Test both languages**: Run E2E tests to catch missing translations
5. **Update both files together**: Never add a key to only one locale file
6. **Use interpolation**: For dynamic values, use `{{variable}}` syntax

## Related Documentation

- [Feature Specification](../specs/005-admin-language-settings/spec.md)
- [Implementation Plan](../specs/005-admin-language-settings/plan.md)
- [Quickstart Guide](../specs/005-admin-language-settings/quickstart.md)
- [i18next Documentation](https://www.i18next.com/)
- [react-i18next Documentation](https://react.i18next.com/)
